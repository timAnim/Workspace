import{b as xe,c as je,f as be,l as W,n as Ge,r as ie,v as se,z as Me}from"/build/_shared/chunk-HPTJOB22.js";import{a as Re}from"/build/_shared/chunk-CEUMSNV4.js";import{d as G,g as oe,h as ye,i as D}from"/build/_shared/chunk-2ADOHOB6.js";D();Ge();var we=G(je());var R=G(oe());D();var g=G(oe());D();var f=G(oe(),1);function L(){return L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},L.apply(this,arguments)}function We(e,t){if(e==null)return{};var o={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(o[i]=e[i]);return o}var qe=["bottom","height","left","right","top","width"],Xe=function(t,o){return t===void 0&&(t={}),o===void 0&&(o={}),qe.some(function(n){return t[n]!==o[n]})},V=new Map,Ae,Qe=function e(){var t=[];V.forEach(function(o,n){var i=n.getBoundingClientRect();Xe(i,o.rect)&&(o.rect=i,t.push(o))}),t.forEach(function(o){o.callbacks.forEach(function(n){return n(o.rect)})}),Ae=window.requestAnimationFrame(e)};function Ye(e,t){return{observe:function(){var n=V.size===0;V.has(e)?V.get(e).callbacks.push(t):V.set(e,{rect:void 0,hasRectChanged:!1,callbacks:[t]}),n&&Qe()},unobserve:function(){var n=V.get(e);if(n){var i=n.callbacks.indexOf(t);i>=0&&n.callbacks.splice(i,1),n.callbacks.length||V.delete(e),V.size||cancelAnimationFrame(Ae)}}}}var q=typeof window<"u"?f.default.useLayoutEffect:f.default.useEffect;function Ze(e,t){t===void 0&&(t={width:0,height:0});var o=f.default.useState(e.current),n=o[0],i=o[1],s=f.default.useReducer(er,t),u=s[0],v=s[1],E=f.default.useRef(!1);return q(function(){e.current!==n&&i(e.current)}),q(function(){if(n&&!E.current){E.current=!0;var S=n.getBoundingClientRect();v({rect:S})}},[n]),f.default.useEffect(function(){if(!!n){var S=Ye(n,function(w){v({rect:w})});return S.observe(),function(){S.unobserve()}}},[n]),u}function er(e,t){var o=t.rect;return e.height!==o.height||e.width!==o.width?o:e}var rr=function(){return 50},tr=function(t){return t},nr=function(t,o){var n=o?"offsetWidth":"offsetHeight";return t[n]},or=function(t){for(var o=Math.max(t.start-t.overscan,0),n=Math.min(t.end+t.overscan,t.size-1),i=[],s=o;s<=n;s++)i.push(s);return i};function Ve(e){var t,o=e.size,n=o===void 0?0:o,i=e.estimateSize,s=i===void 0?rr:i,u=e.overscan,v=u===void 0?1:u,E=e.paddingStart,S=E===void 0?0:E,w=e.paddingEnd,X=w===void 0?0:w,x=e.parentRef,r=e.horizontal,d=e.scrollToFn,P=e.useObserver,c=e.initialRect,p=e.onScrollElement,h=e.scrollOffsetFn,I=e.keyExtractor,F=I===void 0?tr:I,z=e.measureSize,K=z===void 0?nr:z,ae=e.rangeExtractor,le=ae===void 0?or:ae,Fe=r?"width":"height",$=r?"scrollLeft":"scrollTop",b=f.default.useRef({scrollOffset:0,measurements:[]}),fe=f.default.useState(0),Je=fe[0],ve=fe[1];b.current.scrollOffset=Je;var De=P||Ze,Ue=De(x,c),ke=Ue[Fe];b.current.outerSize=ke;var U=f.default.useCallback(function(a){x.current&&(x.current[$]=a)},[x,$]),pe=d||U;d=f.default.useCallback(function(a){pe(a,U)},[U,pe]);var Te=f.default.useState({}),me=Te[0],Q=Te[1],Ke=f.default.useCallback(function(){return Q({})},[]),H=f.default.useRef([]),J=f.default.useMemo(function(){var a=H.current.length>0?Math.min.apply(Math,H.current):0;H.current=[];for(var m=b.current.measurements.slice(0,a),l=a;l<n;l++){var O=F(l),T=me[O],M=m[l-1]?m[l-1].end:S,N=typeof T=="number"?T:s(l),y=M+N;m[l]={index:l,start:M,size:N,end:y,key:O}}return m},[s,me,S,n,F]),ge=(((t=J[n-1])==null?void 0:t.end)||S)+X;b.current.measurements=J,b.current.totalSize=ge;var k=p?p.current:x.current,Y=f.default.useRef(h);Y.current=h,q(function(){if(!k){ve(0);return}var a=function(l){var O=Y.current?Y.current(l):k[$];ve(O)};return a(),k.addEventListener("scroll",a,{capture:!1,passive:!0}),function(){k.removeEventListener("scroll",a)}},[k,$]);var he=sr(b.current),Se=he.start,Ie=he.end,Z=f.default.useMemo(function(){return le({start:Se,end:Ie,overscan:v,size:J.length})},[Se,Ie,v,J.length,le]),Oe=f.default.useRef(K);Oe.current=K;var $e=f.default.useMemo(function(){for(var a=[],m=function(M,N){var y=Z[M],B=J[y],_=L(L({},B),{},{measureRef:function(j){if(j){var te=Oe.current(j,r);if(te!==_.size){var Ne=b.current.scrollOffset;_.start<Ne&&U(Ne+(te-_.size)),H.current.push(y),Q(function(Be){var ne;return L(L({},Be),{},(ne={},ne[_.key]=te,ne))})}}}});a.push(_)},l=0,O=Z.length;l<O;l++)m(l);return a},[Z,U,r,J]),Ee=f.default.useRef(!1);q(function(){Ee.current&&Q({}),Ee.current=!0},[s]);var ee=f.default.useCallback(function(a,m){var l=m===void 0?{}:m,O=l.align,T=O===void 0?"start":O,M=b.current,N=M.scrollOffset,y=M.outerSize;T==="auto"&&(a<=N?T="start":a>=N+y?T="end":T="start"),T==="start"?d(a):T==="end"?d(a-y):T==="center"&&d(a-y/2)},[d]),re=f.default.useCallback(function(a,m){var l=m===void 0?{}:m,O=l.align,T=O===void 0?"auto":O,M=We(l,["align"]),N=b.current,y=N.measurements,B=N.scrollOffset,_=N.outerSize,A=y[Math.max(0,Math.min(a,n-1))];if(!!A){if(T==="auto")if(A.end>=B+_)T="end";else if(A.start<=B)T="start";else return;var j=T==="center"?A.start+A.size/2:T==="end"?A.end:A.start;ee(j,L({align:T},M))}},[ee,n]),He=f.default.useCallback(function(){for(var a=arguments.length,m=new Array(a),l=0;l<a;l++)m[l]=arguments[l];re.apply(void 0,m),requestAnimationFrame(function(){re.apply(void 0,m)})},[re]);return{virtualItems:$e,totalSize:ge,scrollToOffset:ee,scrollToIndex:He,measure:Ke}}var ir=function(t,o,n,i){for(;t<=o;){var s=(t+o)/2|0,u=n(s);if(u<i)t=s+1;else if(u>i)o=s-1;else return s}return t>0?t-1:0};function sr(e){for(var t=e.measurements,o=e.outerSize,n=e.scrollOffset,i=t.length-1,s=function(S){return t[S].start},u=ir(0,i,s,n),v=u;v<i&&t[v].end<n+o;)v++;return{start:u,end:v}}function Ce(e,t){let o={...e.collapsedState,[t]:!1};return{...e,collapsedState:o,items:C(e.nodes,0,o),focusedNodeId:t}}function de(e,t){let o={...e.collapsedState,[t]:!0};return{...e,collapsedState:o,items:C(e.nodes,0,o),focusedNodeId:t}}function ce(e,t){let o=e.items.find(({id:s})=>s===t);if(!o||!o.node.children||o.node.children.length===0)return e;if(o.node.children.every(s=>e.collapsedState[s.id])){let s=o.node.children.reduce((u,v)=>({...u,[v.id]:!1}),e.collapsedState);return{...e,collapsedState:s,items:C(e.nodes,0,s),focusedNodeId:t}}let i=o.node.children.reduce((s,u)=>({...s,[u.id]:!0}),e.collapsedState);return{...e,collapsedState:i,items:C(e.nodes,0,i),focusedNodeId:t}}function ze(e){let t=(0,g.useCallback)((r,d)=>{var P;switch(d.type){case"BLUR":return{...r,focusedNodeId:null};case"TOGGLE_NODE":return r.collapsedState[d.id]?Ce(r,d.id):d.source&&(d.source.shiftKey||d.source.altKey)?ce(r,d.id):de(r,d.id);case"COLLAPSE_ALL_NODES":return r.items.reduceRight((c,p)=>de(c,p.id),r);case"FOCUS_NODE":{if(r.items.findIndex(({id:p})=>p===d.id)===-1){let p=_e(r.nodes,d.id);if(!p)return r;let I=((P=Le(r.nodes,p))!=null?P:[]).reduce((F,z)=>({...F,[z]:!1}),r.collapsedState);return{...r,collapsedState:I,items:C(r.nodes,0,I),focusedNodeId:d.id}}return{...r,focusedNodeId:d.id}}case"FOCUS_FIRST":case"MOVE_TO_TOP":{let c=r.items[0];return c?{...r,focusedNodeId:c.id}:r}case"MOVE_TO_BOTTOM":{let c=r.items[r.items.length-1];return c?{...r,focusedNodeId:c.id}:r}case"MOVE_DOWN":{if(!r.focusedNodeId){let h=r.items[0];return h?{...r,focusedNodeId:h.id}:r}let c=r.items.findIndex(h=>h.id===r.focusedNodeId);if(c===-1||r.items.length<=c+1)return r;let p=r.items[c+1];return{...r,focusedNodeId:p.id}}case"MOVE_UP":{let c=r.items.findIndex(h=>h.id===r.focusedNodeId);if(c===-1||c===0)return r;let p=r.items[c-1];return{...r,focusedNodeId:p.id}}case"MOVE_RIGHT":{if(!r.focusedNodeId)return r;if(r.collapsedState[r.focusedNodeId])return Ce(r,r.focusedNodeId);if(d.source&&(d.source.shiftKey||d.source.altKey))return ce(r,r.focusedNodeId);let p=r.items.findIndex(I=>I.id===r.focusedNodeId);if(p===-1||r.items.length<=p+1)return r;let h=r.items[p+1];return{...r,focusedNodeId:h.id}}case"MOVE_LEFT":{if(!r.focusedNodeId)return r;let c=r.items.find(I=>I.id===r.focusedNodeId);if(!c)return r;let p=c.node.children&&c.node.children.length>0,h=r.collapsedState[r.focusedNodeId];if(p&&!h)return d.source&&(d.source.shiftKey||d.source.altKey)?ce(r,r.focusedNodeId):de(r,r.focusedNodeId);if(!p||h){let I=r.items.findIndex(z=>z.node.children&&z.node.children.map(K=>K.id).includes(r.focusedNodeId));if(I===-1)return r;let F=r.items[I];return{...r,focusedNodeId:F.id}}return r}case"RESTORE_STATE":{let c={...r,...d.restoredState};return{...c,items:C(c.nodes,0,c.collapsedState)}}default:return r}},[]),o=(0,g.useCallback)(({nodes:r})=>({nodes:r,items:C(r),collapsedState:{},focusedNodeId:null}),[e.persistState,e.id]),[n,i]=(0,g.useReducer)(t,{nodes:e.nodes},o),s=(0,g.useRef)(!1);(0,g.useEffect)(()=>{!s.current||e.persistState&&localStorage.setItem(`${e.id}-virtual-tree-state`,JSON.stringify(be(n,"collapsedState")))},[n.collapsedState,e.id,e.persistState,s.current]),(0,g.useEffect)(()=>{if(!e.persistState||s.current)return;s.current=!0;let r=localStorage.getItem(`${e.id}-virtual-tree-state`);if(r){let d=JSON.parse(r);i({type:"RESTORE_STATE",restoredState:d})}},[e.persistState,e.id,i,s.current]);let u=Ve({size:n.items.length,parentRef:e.parentRef,estimateSize:e.estimateSize,overscan:e.overscan,initialRect:e.initialRect,useObserver:e.useObserver}),v=u.virtualItems.map(r=>{let d=n.items[r.index];return{node:d.node,depth:d.depth,size:r.size,start:r.start,virtualItem:r,getItemProps:cr(d,r,n,i),isCollapsed:d.isCollapsed}}),E=(0,g.useCallback)((r,d)=>{i({type:"TOGGLE_NODE",id:r,source:d})},[i]),S=(0,g.useCallback)(r=>{i({type:"FOCUS_NODE",id:r})},[i]),w=(0,g.useCallback)(()=>i({type:"FOCUS_FIRST"}),[i]),X=(0,g.useCallback)(()=>i({type:"BLUR"}),[i]),x=(0,g.useCallback)(r=>{let d=n.items.findIndex(P=>P.id===r);d!==-1&&u.scrollToIndex(d,{align:"auto"})},[n.items,u.scrollToIndex,i]);return(0,g.useEffect)(()=>{n.focusedNodeId&&x(n.focusedNodeId)},[n.focusedNodeId,x]),{nodes:v,totalSize:u.totalSize,toggleNode:E,focusNode:S,focusFirst:w,blur:X,focusedNodeId:n.focusedNodeId,getTreeProps:(0,g.useCallback)(dr(i),[i]),scrollToNode:x}}function C(e,t=0,o={}){return e.flatMap((n,i)=>{let s=n.children?o[n.id]?[]:C(n.children,t+1,o):[];return[{id:n.id,depth:t,node:n,pos:i+1,size:e.length,isCollapsed:!!o[n.id]},...s]})}function dr(e){return()=>({role:"tree",tabIndex:-1,onKeyDown:t=>{if(!t.defaultPrevented)switch(t.key){case"Home":{e({type:"MOVE_TO_TOP",source:t.nativeEvent}),t.preventDefault();break}case"End":{e({type:"MOVE_TO_BOTTOM",source:t.nativeEvent}),t.preventDefault();break}case"Down":case"ArrowDown":{e({type:"MOVE_DOWN",source:t.nativeEvent}),t.preventDefault();break}case"Up":case"ArrowUp":{e({type:"MOVE_UP",source:t.nativeEvent}),t.preventDefault();break}case"Left":case"ArrowLeft":{t.altKey?e({type:"COLLAPSE_ALL_NODES"}):e({type:"MOVE_LEFT",source:t.nativeEvent}),t.preventDefault();break}case"Right":case"ArrowRight":{e({type:"MOVE_RIGHT",source:t.nativeEvent}),t.preventDefault();break}}}})}function cr(e,t,o,n){let{depth:i,pos:s,size:u,node:v,isCollapsed:E}=e;return()=>({"aria-expanded":v.children&&v.children.length>0&&!E,"aria-level":i+1,"aria-posinset":s,"aria-setsize":u,role:"treeitem",tabIndex:v.id===o.focusedNodeId?-1:void 0,onClick:S=>{S.defaultPrevented||v.id!==o.focusedNodeId&&n({type:"FOCUS_NODE",id:v.id})}})}function _e(e,t){let o=e.find(n=>n.id===t);if(o)return o;for(let n of e){let i=_e(n.children||[],t);if(i)return i}}function Le(e,t,o=[]){if(e.findIndex(i=>i.id===t.id)!==-1)return[...o,t.id];for(let i of e){if(!i.children)continue;let s=Le(i.children||[],t,[...o,i.id]);if(s&&s.length>o.length)return s}}var ur={width:800,height:600},Pe=(0,R.createContext)({});function Vr({children:e,...t}){let o=ar(t);return ye.createElement(Pe.Provider,{value:o},e)}function ar(e){let t=(0,R.useRef)(null),{doc:o}=Me(),[n]=xe(),i=(0,R.useMemo)(()=>lr(n),[n]);return{tree:ze({id:o.id,nodes:i,parentRef:t,estimateSize:(0,R.useCallback)(u=>32,[]),initialRect:ur,overscan:e.overscan,persistState:!0}),parentRef:t}}function Cr(){let e=(0,R.useContext)(Pe);return Re(e,"useJsonTreeViewContext must be used within a JsonTreeViewContext.Provider"),e}function lr(e){var n;let t=W(e),o=new we.JSONHeroPath("$");return(n=ue(t,o))!=null?n:[]}function ue(e,t){if(e.name==="array")return e.value.map((o,n)=>{let i=W(o),s=t.child(n.toString());return{id:s.toString(),name:n.toString(),title:n.toString(),longTitle:`Index ${n.toString()}`,subtitle:ie(i),icon:se(i),children:ue(i,s)}});if(e.name==="object")return Object.entries(e.value).map(([o,n])=>{let i=o.replace(/\./g,"\\."),s=W(n),u=t.child(i);return{id:u.toString(),name:o,title:o,subtitle:ie(s),icon:se(s),children:ue(s,u)}})}export{Ve as a,Vr as b,Cr as c};
