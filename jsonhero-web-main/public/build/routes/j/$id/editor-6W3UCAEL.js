import{g as k,h as N,i as K,j as D,m as H,n as I,o as A}from"/build/_shared/chunk-ENERXVFP.js";import{B as T,C as M,D as L,b as J,c as G,z as O}from"/build/_shared/chunk-HPTJOB22.js";import"/build/_shared/chunk-LT5HO34M.js";import{b as x}from"/build/_shared/chunk-LYGVB3WT.js";import"/build/_shared/chunk-CEUMSNV4.js";import{b as U}from"/build/_shared/chunk-CEVX6J5K.js";import"/build/_shared/chunk-GZMK5MKI.js";import{d as b,g as V,h as r,i as s}from"/build/_shared/chunk-2ADOHOB6.js";s();s();s();s();var d=b(V());var Q={json:D},w={language:"json",readOnly:!0,selection:{start:0,end:0}};function q(p){let{content:l,language:f,readOnly:i,onChange:u,onUpdate:C,selection:t}={...w,...p},[j]=U(),a=H(),m=Q[f];a.push(m());let e=(0,d.useRef)(null),{setContainer:g,view:n,state:o}=N({container:e.current,extensions:a,editable:!i,contentEditable:!i,value:l,autoFocus:!1,theme:j==="light"?A():I(),indentWithTab:!1,basicSetup:!1,onChange:u,onUpdate:C});(0,d.useEffect)(()=>{e.current&&g(e.current)},[e.current]);let h=(0,d.useRef)(!1);(0,d.useEffect)(()=>{var E,P;if(!h.current&&n){h.current=!0;let v=(E=t==null?void 0:t.start)!=null?E:w.selection.start,z=(P=t==null?void 0:t.end)!=null?P:w.selection.end,R=o==null?void 0:o.doc.lineAt(v).number,B={selection:{anchor:v,head:z},effects:k.scrollIntoView(v,{y:"start",yMargin:100})};n.dispatch(B)}},[t,n,h.current]);let{minimal:y}=O();return L("ctrl+a,meta+a,command+a",E=>{E.preventDefault(),n==null||n.dispatch({selection:{anchor:0,head:o==null?void 0:o.doc.length}})},[n,o]),r.createElement("div",null,r.createElement("div",{className:`${y?"h-jsonViewerHeightMinimal":"h-jsonViewerHeight"} overflow-y-auto no-scrollbar`,ref:e}))}var c=b(V());var F=b(K()),S=b(G());function W(){let[p]=J(),{selectedNodeId:l}=T(),{goToNodeId:f}=M(),[i]=x(),u=(0,c.useMemo)(()=>F.default.stringify(p,null,(i==null?void 0:i.indent)||2),[p,i]),C=(0,c.useMemo)(()=>{if(!l)return;let m=new S.JSONHeroPath(l).jsonPointer(),e=u.pointers[m];if(e)return e.key?{start:e.key.pos,end:e.valueEnd.pos}:{start:e.value.pos,end:e.valueEnd.pos}},[l,u]),t=(0,c.useRef)(void 0),j=(0,c.useCallback)(a=>{if(!a.selectionSet)return;let m=a.state.selection.ranges[0],e=a.state.doc.lineAt(m.anchor);if(t.current&&t.current===e.number)return;t.current=e.number;let g=Object.entries(u.pointers).find(([h,y])=>y.value.line===e.number-1);if(!g)return;let[n]=g,o=S.JSONHeroPath.fromPointer(n);f(o.toString(),"editor")},[f]);return r.createElement(q,{language:"json",content:u.json,readOnly:!0,onUpdate:j,selection:C})}function $(){return r.createElement(W,null)}export{$ as default};
